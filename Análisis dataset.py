# -*- coding: utf-8 -*-
"""PROYECTO.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1OiWsqfZ_RSJfBDPDlJ9H-GWzYDRHtSNw
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from datetime import datetime
import warnings
import re

warnings.filterwarnings('ignore')
print("âœ… LibrerÃ­as importadas correctamente")

# Cargar el archivo CSV
try:
    df = pd.read_csv('/content/social_media_usage.csv')
    print("âœ… Archivo cargado exitosamente")
except FileNotFoundError:
    print("âŒ Archivo no encontrado. Subiendo archivo...")
    from google.colab import files
    uploaded = files.upload()
    filename = list(uploaded.keys())[0]
    df = pd.read_csv(filename)
    print(f"âœ… Archivo '{filename}' cargado exitosamente")

print(f"ğŸ“ Dimensiones: {df.shape[0]} filas Ã— {df.shape[1]} columnas")

# EXPLORACIÃ“N INICIAL - IDENTIFICAR PROBLEMAS
print("ğŸ” EXPLORACIÃ“N INICIAL DEL DATASET")
print("=" * 50)

# InformaciÃ³n bÃ¡sica
print(f"ğŸ“Š Dimensiones: {df.shape[0]} filas x {df.shape[1]} columnas")

# AnÃ¡lisis de valores faltantes
valores_faltantes = df.isnull().sum()
print(f"\nâ“ VALORES FALTANTES POR COLUMNA:")
for columna, cantidad in valores_faltantes.items():
    if cantidad > 0:
        porcentaje = (cantidad / len(df)) * 100
        print(f"   âŒ {columna}: {cantidad} ({porcentaje:.1f}%)")
    else:
        print(f"   âœ… {columna}: {cantidad}")

print(f"\nğŸ“Š Total de valores faltantes: {valores_faltantes.sum()}")

# Otros problemas detectados
cadenas_vacias = (df.astype(str) == '').sum().sum()
print(f"ğŸ“ Cadenas vacÃ­as detectadas: {cadenas_vacias}")

print("\nğŸ“‹ InformaciÃ³n detallada:")
df.info()

# # PASO 1: LIMPIEZA DE VALORES FALTANTES
# print("ğŸ§¹ LIMPIEZA DE VALORES FALTANTES")
# print("=" * 50)

# # Crear copia para limpieza
# df_limpio = df.copy()

# print(f"ğŸ“‹ Antes: {df_limpio.isnull().sum().sum()} valores faltantes")

# # Estandarizar valores faltantes
# df_limpio = df_limpio.replace(['', ' ', 'nan', 'None'], np.nan)

# # Rellenar por tipo de columna
# df_limpio['Nombre'] = df_limpio['Nombre'].fillna('Sin Nombre')
# df_limpio['Email'] = df_limpio['Email'].fillna('sin.email@pendiente.com')
# df_limpio['TelÃ©fono'] = df_limpio['TelÃ©fono'].fillna('Sin telÃ©fono')

# # Edades: convertir a numÃ©rico y rellenar con mediana
# df_limpio['Edad'] = pd.to_numeric(df_limpio['Edad'], errors='coerce')
# mediana_edad = df_limpio['Edad'].median()
# df_limpio['Edad'] = df_limpio['Edad'].fillna(mediana_edad)
# print(f"   âœ… Edades rellenadas con mediana: {mediana_edad}")

# # Calificaciones: rellenar con promedio
# df_limpio['CalificaciÃ³n'] = pd.to_numeric(df_limpio['CalificaciÃ³n'], errors='coerce')
# promedio_calif = df_limpio['CalificaciÃ³n'].mean()
# df_limpio['CalificaciÃ³n'] = df_limpio['CalificaciÃ³n'].fillna(promedio_calif)
# print(f"   âœ… Calificaciones rellenadas con promedio: {promedio_calif:.1f}")

# print(f"\nğŸ“‹ DespuÃ©s: {df_limpio.isnull().sum().sum()} valores faltantes")
# print("âœ… Limpieza de valores faltantes completada")

df

# PASO 2: LIMPIEZA DE DATOS DE TEXTO
print("ğŸ”¤ LIMPIEZA DE DATOS DE TEXTO")
print("=" * 50)
#  Crear copia para limpieza
df_limpio = df.copy()
# NOMBRES
print("ğŸ“‹ Nombres ANTES:")
for i, nombre in enumerate(df_limpio['User_ID'], 1):
    print(f"   {i:2d}. '{nombre}'")

# Limpiar nombres
df_limpio['User_ID'] = (df_limpio['User_ID'].astype(str)
                       .str.strip()
                       .str.replace(r'\s+', ' ', regex=True)
                       .str.title())

print("\nğŸ“‹ Nombres DESPUÃ‰S:")
for i, nombre in enumerate(df_limpio['User_ID'], 1):
    print(f"   {i:2d}. '{nombre}'")

print("\nâœ… Nombres estandarizados a formato TÃ­tulo")

# # PASO 3: LIMPIEZA DE EMAILS
# print("ğŸ“§ LIMPIEZA DE EMAILS")
# print("=" * 50)

# print("ğŸ“‹ Emails ANTES:")
# for i, email in enumerate(df_limpio['Email'], 1):
#     print(f"   {i:2d}. '{email}'")

# # Limpiar emails
# df_limpio['Email'] = df_limpio['Email'].str.lower().str.strip()

# # Validar emails con patrÃ³n
# patron_email = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
# for i in range(len(df_limpio)):
#     email = df_limpio['Email'].iloc[i]
#     if not re.match(patron_email, str(email)) and 'pendiente' not in str(email):
#         df_limpio['Email'].iloc[i] = f"{email}.REVISAR@pendiente.com"

# print("\nğŸ“‹ Emails DESPUÃ‰S:")
# for i, email in enumerate(df_limpio['Email'], 1):
#     if 'REVISAR' in email:
#         print(f"   {i:2d}. '{email}' âš ï¸ NECESITA REVISIÃ“N")
#     else:
#         print(f"   {i:2d}. '{email}' âœ…")

# emails_revisar = df_limpio['Email'].str.contains('REVISAR').sum()
# print(f"\nğŸ“Š Emails que necesitan revisiÃ³n: {emails_revisar}")
# print("âœ… Emails procesados")

# RESULTADOS FINALES Y COMPARACIÃ“N
print("ğŸ“Š RESUMEN FINAL DE LA LIMPIEZA")
print("=" * 70)

# ComparaciÃ³n antes vs despuÃ©s
print("ğŸ”„ COMPARACIÃ“N ANTES VS DESPUÃ‰S:")
valores_antes = df.isnull().sum().sum()
valores_despues = df_limpio.isnull().sum().sum()

print(f"ğŸ“Š Registros: {len(df)} â†’ {len(df_limpio)}")
print(f"ğŸ“Š Columnas: {len(df.columns)} â†’ {len(df_limpio.columns)}")
print(f"â“ Valores faltantes: {valores_antes} â†’ {valores_despues}")
print(f"ğŸ“ˆ Valores corregidos: {valores_antes - valores_despues}")

print(f"\nğŸ“‹ CAMBIOS POR COLUMNA:")
for columna in df_limpio.columns:
    antes = df[columna].isnull().sum()
    despues = df_limpio[columna].isnull().sum()
    print(f"   {columna}: {antes} â†’ {despues} faltantes")

# Mostrar dataset final
print(f"\nğŸ¯ DATASET FINAL LIMPIO:")
display(df_limpio)

# EstadÃ­sticas finales
print(f"\nğŸ‰ ESTADÃSTICAS FINALES:")
print(f"âœ… Total de registros: {len(df_limpio)}")
print(f"âœ… Total de columnas: {len(df_limpio.columns)}")
print(f"âœ… Valores faltantes: {df_limpio.isnull().sum().sum()}")
completitud = ((df_limpio.size - df_limpio.isnull().sum().sum()) / df_limpio.size * 100)
print(f"âœ… Completitud: {completitud:.1f}%")

print(f"\nğŸ“‹ InformaciÃ³n del dataset limpio:")
df_limpio.info()

# GUARDAR DATASET Y CONSEJOS FINALES
print("ğŸ’¾ GUARDANDO DATASET LIMPIO")
print("=" * 50)

# Guardar archivos
try:
    fecha = datetime.now().strftime('%Y%m%d_%H%M')

    # Guardar CSV
    nombre_csv = f'dataset_limpio_{fecha}.csv'
    df_limpio.to_csv(nombre_csv, index=False, encoding='utf-8')
    print(f"âœ… CSV guardado: {nombre_csv}")

    # Guardar Excel
    nombre_excel = f'dataset_limpio_{fecha}.xlsx'
    df_limpio.to_excel(nombre_excel, index=False)
    print(f"âœ… Excel guardado: {nombre_excel}")

    # Crear reporte
    nombre_reporte = f'reporte_limpieza_{fecha}.txt'
    with open(nombre_reporte, 'w', encoding='utf-8') as f:
        f.write(f"REPORTE DE LIMPIEZA DE DATOS\n")
        f.write(f"Fecha: {datetime.now().strftime('%Y-%m-%d %H:%M')}\n")
        f.write(f"Dataset original: {df.shape[0]} filas, {df.shape[1]} columnas\n")
        f.write(f"Dataset limpio: {df_limpio.shape[0]} filas, {df_limpio.shape[1]} columnas\n")
        f.write(f"Valores corregidos: {valores_antes - valores_despues}\n")
        f.write(f"\nProcesos aplicados:\n")
        f.write(f"- EstandarizaciÃ³n de valores faltantes\n")
        f.write(f"- Limpieza de texto (nombres y emails)\n")
        f.write(f"- ValidaciÃ³n de datos numÃ©ricos\n")
        f.write(f"- NormalizaciÃ³n de fechas\n")
        f.write(f"- Formato de nÃºmeros de telÃ©fono\n")
        f.write(f"\nÂ¡Dataset listo para anÃ¡lisis!\n")

    print(f"âœ… Reporte guardado: {nombre_reporte}")
    print("\nğŸ“ Para descargar: Carpeta (panel izquierdo) â†’ Clic derecho â†’ Descargar")

except Exception as e:
    print(f"âš ï¸ Error al guardar: {e}")

print(f"\nğŸ“ Â¡FELICITACIONES!")
print("=" * 50)
print("âœ… Has completado la limpieza de datos exitosamente")
print("âœ… Tu dataset estÃ¡ listo para anÃ¡lisis")
print("âœ… Ahora puedes aplicar estas tÃ©cnicas a tus propios datos")

print(f"\nğŸš€ PRÃ“XIMOS PASOS SUGERIDOS:")
print("1. ğŸ“Š AnÃ¡lisis exploratorio de datos (EDA)")
print("2. ğŸ“ˆ Crear visualizaciones para entender patrones")
print("3. ğŸ” Buscar correlaciones entre variables")
print("4. ğŸ¤– Aplicar tÃ©cnicas de machine learning")
print("5. ğŸ“‹ Generar reportes y conclusiones")

print(f"\nğŸ“š RECURSOS PARA SEGUIR APRENDIENDO:")
print("ğŸŒ DocumentaciÃ³n oficial de Pandas")
print("ğŸ“– Kaggle Learn: Data Cleaning Course")
print("ğŸ¥ YouTube: Tutoriales de Python para anÃ¡lisis de datos")
print("ğŸ“ PrÃ¡ctica con datasets reales en Kaggle")

print(f"\nğŸ’¡ PARA CARGAR TUS PROPIOS DATOS:")
print("# Cargar CSV: df = pd.read_csv('tu_archivo.csv')")
print("# Cargar Excel: df = pd.read_excel('tu_archivo.xlsx')")
print("# Luego aplica las mismas tÃ©cnicas de limpieza")

print(f"\nğŸŒŸ Â¡El mundo de los datos te espera!")
print("ğŸ’ª Ahora tienes las habilidades para limpiar cualquier dataset")
print("ğŸ‰ Â¡Has completado el manual de limpieza de datos!")